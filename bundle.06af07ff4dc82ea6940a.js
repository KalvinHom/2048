(()=>{"use strict";const t=new class{constructor(){this.setDefaults()}setDefaults(){this.board=new class{constructor(){this.board=Array(4).fill().map((()=>Array(4).fill(0))),this.actions=Array(4).fill().map((()=>Array(4).fill().map((t=>({action:0}))))),this.numTranslate=0,this.ready=!0,this.score=0}beginTurn(){this.ready=!1}newPiece(){let t,s;do{t=Math.floor(4*Math.random()),s=Math.floor(4*Math.random())}while(0!=this.board[s][t]);const a=Math.floor(10*Math.random());this.board[s][t]=0==a?4:2,this.actions[s][t].action=-1,console.log(`new piece at ${t}, ${s}`)}moveLeft(){let t=!1;for(let s=0;s<4;s++)for(let a=0;a<4;a++){const e=this.getNextValue(a+1,s,1);if(-1==e)break;0==this.board[s][a]?(t=!0,this.board[s][a]=this.board[s][e],this.board[s][e]=0,this.actions[s][e].action=1,this.actions[s][e].translate=[a-e,0],a--):this.board[s][a]==this.board[s][e]&&(t=!0,this.board[s][a]*=2,this.board[s][e]=0,this.actions[s][e].action=2,this.actions[s][e].translate=[a-e,0],this.score+=this.board[s][a])}return t}moveRight(){let t=!1;for(let s=0;s<4;s++)for(let a=3;a>=0;a--){const e=this.getNextValue(a-1,s,-1);if(-1==e)break;0==this.board[s][a]?(t=!0,this.board[s][a]=this.board[s][e],this.board[s][e]=0,this.actions[s][e].action=1,this.actions[s][e].translate=[a-e,0],a++):this.board[s][a]==this.board[s][e]&&(t=!0,this.board[s][a]*=2,this.board[s][e]=0,this.actions[s][e].action=2,this.actions[s][e].translate=[a-e,0],this.score+=this.board[s][a])}return t}moveUp(){let t=!1;for(let s=0;s<4;s++)for(let a=0;a<4;a++){const e=this.getNextYValue(s,a+1,1);if(-1==e)break;0==this.board[a][s]?(t=!0,this.board[a][s]=this.board[e][s],this.board[e][s]=0,this.actions[e][s].action=1,this.actions[e][s].translate=[0,a-e],a--):this.board[a][s]==this.board[e][s]&&(t=!0,this.board[a][s]*=2,this.board[e][s]=0,this.actions[e][s].action=2,this.actions[e][s].translate=[0,a-e],this.score+=this.board[a][s])}return t}moveDown(){let t=!1;for(let s=0;s<4;s++)for(let a=3;a>=0;a--){const e=this.getNextYValue(s,a-1,-1);if(-1==e)break;0==this.board[a][s]?(t=!0,this.board[a][s]=this.board[e][s],this.board[e][s]=0,this.actions[e][s].action=1,this.actions[e][s].translate=[0,a-e],a++):this.board[a][s]==this.board[e][s]&&(t=!0,this.board[a][s]*=2,this.board[e][s]=0,this.actions[e][s].action=2,this.actions[e][s].translate=[0,a-e],this.score+=this.board[a][s])}return t}getNextValue(t,s,a){for(;t>=0&&t<4;){if(0!=this.board[s][t])return t;t+=a}return-1}getNextYValue(t,s,a){for(;s>=0&&s<4;){if(0!=this.board[s][t])return s;s+=a}return-1}style(t,s){return-1==this.actions[t][s].action?"new-tile":"normal"}draw(){console.log("beginning board draw"),console.log(this.actions);var t=!1;for(let a=0;a<4;a++)for(let e=0;e<4;e++)if(0==this.board[a][e]||(this.style(a,e),this.board[a][e]),0!=this.actions[a][e].action&&-1!=this.actions[a][e].action){t=!0,document.getElementsByClassName("grid-row")[a].getElementsByClassName("grid-cell")[e].getElementsByClassName("tile")[0].style.transform=`translate(${106.25*this.actions[a][e].translate[0]+15*this.actions[a][e].translate[0]}px, ${106.25*this.actions[a][e].translate[1]+15*this.actions[a][e].translate[1]}px)`,this.numTranslate++,this.transitioning=!0,console.log(`added numTranslate:${this.numTranslate}`);var s=this;$(".tile").each((function(){this.addEventListener("transitionend",(function t(a){console.log(a.currentTarget),a.currentTarget.removeEventListener(a.type,t),s.completeTransitions()}))}))}t||(this.drawBoard(),this.ready=!0)}drawBoard(){for(let a=0;a<4;a++)for(let e=0;e<4;e++){var t=0==this.board[a][e]?"":255-10*Math.log2(this.board[a][e]),s=0==this.board[a][e]?"":`<div class="tile ${this.style(a,e)}" style="background: rgb(255, ${t}, ${t})\n            ">${this.board[a][e]}</div>`;document.getElementsByClassName("grid-row")[a].getElementsByClassName("grid-cell")[e].innerHTML=s,this.actions[a][e].action=0,document.getElementById("score-counter").innerHTML=this.score}}completeTransitions(){this.transitioning&&(console.log("complete transition"),this.drawBoard(),this.ready=!0,this.transitioning=!1)}},this.canvas=new class{constructor(t){}}}isReady(){return this.board.ready}startGame(){this.lastRenderTime=Date.now(),this.board.newPiece(),this.board.newPiece(),this.board.drawBoard()}moveLeft(){this.board.beginTurn(),this.board.moveLeft()&&this.board.newPiece(),this.board.draw()}moveRight(){this.board.beginTurn(),this.board.moveRight()&&this.board.newPiece(),this.board.draw()}moveUp(){this.board.beginTurn(),this.board.moveUp()&&this.board.newPiece(),this.board.draw()}moveDown(){this.board.beginTurn(),this.board.moveDown()&&this.board.newPiece(),this.board.draw()}};t.startGame();let s=!1;window.addEventListener("keydown",(function(a){if(a.preventDefault(),!s&&t.isReady()){switch(s=!0,a.key,a.preventDefault(),a.key){case"ArrowLeft":case"a":t.moveLeft();break;case"ArrowRight":case"d":t.moveRight();break;case"ArrowUp":case"w":t.moveUp();break;case"ArrowDown":case"s":t.moveDown();break;default:return void(s=!1)}s=!1}}))})();
//# sourceMappingURL=bundle.06af07ff4dc82ea6940a.js.map