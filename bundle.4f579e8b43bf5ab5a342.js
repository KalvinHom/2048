(()=>{"use strict";const t=new class{constructor(){this.setDefaults()}setDefaults(){this.board=new class{constructor(){this.board=Array(4).fill().map((()=>Array(4).fill(0))),this.actions=Array(4).fill().map((()=>Array(4).fill().map((t=>({action:0}))))),this.canvas=document.querySelector("canvas.board"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.context=this.canvas.getContext("2d"),this.ready=!0}beginTurn(){this.ready=!1}newPiece(){let t,a;do{t=Math.floor(4*Math.random()),a=Math.floor(4*Math.random())}while(0!=this.board[a][t]);const e=Math.floor(10*Math.random());this.board[a][t]=0==e?4:2,this.actions[a][t].action=-1,console.log(`new piece at ${t}, ${a}`)}moveLeft(){let t=!1;for(let a=0;a<4;a++)for(let e=0;e<4;e++){const s=this.getNextValue(e+1,a,1);if(-1==s)break;0==this.board[a][e]?(t=!0,this.board[a][e]=this.board[a][s],this.board[a][s]=0,this.actions[a][s].action=1,this.actions[a][s].translate=[e-s,0],e--):this.board[a][e]==this.board[a][s]&&(t=!0,this.board[a][e]*=2,this.board[a][s]=0,this.actions[a][s].action=2,this.actions[a][s].translate=[e-s,0])}return t}moveRight(){let t=!1;for(let a=0;a<4;a++)for(let e=3;e>=0;e--){const s=this.getNextValue(e-1,a,-1);if(-1==s)break;0==this.board[a][e]?(t=!0,this.board[a][e]=this.board[a][s],this.board[a][s]=0,this.actions[a][s].action=1,this.actions[a][s].translate=[e-s,0],e++):this.board[a][e]==this.board[a][s]&&(t=!0,this.board[a][e]*=2,this.board[a][s]=0,this.actions[a][s].action=2,this.actions[a][s].translate=[e-s,0])}return t}moveUp(){let t=!1;for(let a=0;a<4;a++)for(let e=0;e<4;e++){const s=this.getNextYValue(a,e+1,1);if(-1==s)break;0==this.board[e][a]?(t=!0,this.board[e][a]=this.board[s][a],this.board[s][a]=0,this.actions[s][a].action=1,this.actions[s][a].translate=[0,e-s],e--):this.board[e][a]==this.board[s][a]&&(t=!0,this.board[e][a]*=2,this.board[s][a]=0,this.actions[s][a].action=2,this.actions[s][a].translate=[0,e-s])}return t}moveDown(){let t=!1;for(let a=0;a<4;a++)for(let e=3;e>=0;e--){const s=this.getNextYValue(a,e-1,-1);if(-1==s)break;0==this.board[e][a]?(t=!0,this.board[e][a]=this.board[s][a],this.board[s][a]=0,this.actions[s][a].action=1,this.actions[s][a].translate=[0,e-s],e++):this.board[e][a]==this.board[s][a]&&(t=!0,this.board[e][a]*=2,this.board[s][a]=0,this.actions[s][a].action=2,this.actions[s][a].translate=[0,e-s])}return t}getNextValue(t,a,e){for(;t>=0&&t<4;){if(0!=this.board[a][t])return t;t+=e}return-1}getNextYValue(t,a,e){for(;a>=0&&a<4;){if(0!=this.board[a][t])return a;a+=e}return-1}style(t,a){return-1==this.actions[t][a]?"new-tile":"normal"}draw(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),console.log("beginning board draw");for(let t=0;t<4;t++)for(let a=0;a<4;a++)0==this.board[t][a]||(this.style(t,a),this.board[t][a]),0!=this.actions[t][a].action&&-1!=this.actions[t][a].action&&(document.getElementsByClassName("grid-row")[t].getElementsByClassName("grid-cell")[a].getElementsByClassName("tile")[0].style.transform=`translate(${106.25*this.actions[t][a].translate[0]+15*this.actions[t][a].translate[0]}px, ${106.25*this.actions[t][a].translate[1]+15*this.actions[t][a].translate[1]}px)`);var t=this;setTimeout((function(){for(let s=0;s<4;s++)for(let i=0;i<4;i++){var a=0==t.board[s][i]?"":255-10*Math.log2(t.board[s][i]),e=0==t.board[s][i]?"":`<div class="tile ${t.style(s,i)}" style="background: rgb(255, ${a}, ${a})\n              ">${t.board[s][i]}</div>`;document.getElementsByClassName("grid-row")[s].getElementsByClassName("grid-cell")[i].innerHTML=e,t.actions[s][i].action=0}t.ready=!0}),300)}},this.canvas=new class{constructor(t){}}}isReady(){return this.board.ready}startGame(){this.lastRenderTime=Date.now(),this.board.newPiece(),this.board.newPiece(),this.board.draw()}moveLeft(){this.board.beginTurn(),this.board.moveLeft()&&this.board.newPiece(),this.board.draw()}moveRight(){this.board.beginTurn(),this.board.moveRight()&&this.board.newPiece(),this.board.draw()}moveUp(){this.board.beginTurn(),this.board.moveUp()&&this.board.newPiece(),this.board.draw()}moveDown(){this.board.beginTurn(),this.board.moveDown()&&this.board.newPiece(),this.board.draw()}render(){this.board.draw()}};t.startGame();let a=!1;window.addEventListener("keydown",(function(e){if(e.preventDefault(),!a&&t.isReady()){switch(a=!0,e.key,e.preventDefault(),e.key){case"ArrowLeft":case"a":t.moveLeft();break;case"ArrowRight":case"d":t.moveRight();break;case"ArrowUp":case"w":t.moveUp();break;case"ArrowDown":case"s":t.moveDown();break;default:return void(a=!1)}a=!1}}))})();
//# sourceMappingURL=bundle.4f579e8b43bf5ab5a342.js.map